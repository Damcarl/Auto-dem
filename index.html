<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dati da Google Sheet</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://unpkg.com/tabletop@1.5.1/tabletop.js"></script>
</head>
<body>
  <div class="container">
    <h1>ðŸ“Š Dati da Google Sheets</h1>
    <p>Questa tabella mostra i dati aggiornati in tempo reale dal foglio Google.</p>
    <div id="table-container">Caricamento datiâ€¦</div>
  </div>

  <script>
    // Usa solo lâ€™ID del foglio
    const publicSpreadsheetId = '2PACX-1vQ4_CU-hS1RLEXHFqxK_RFSK1D6d18nVWZDMr5g97iIMqqDtOG-H_XBgfClTfxtIlRqrgPbhog_CfLy';

    function init() {
      Tabletop.init({
        key: publicSpreadsheetId,
        callback: showInfo,
        simpleSheet: true
      });
    }

    function showInfo(data, tabletop) {
      // âš  Se data Ã¨ undefined o vuoto, mostra errore
      if (!data || data.length === 0) {
        document.getElementById('table-container').innerText = "Nessun dato trovato oppure il foglio non Ã¨ pubblicato correttamente.";
        return;
      }

      let table = '<table><thead><tr>';
      // intestazioni
      for (let key in data[0]) {
        table += `<th>${key}</th>`;
      }
      table += '</tr></thead><tbody>';
      // righe
      data.forEach(row => {
        table += '<tr>';
        for (let key in row) {
          table += `<td>${row[key]}</td>`;
        }
        table += '</tr>';
      });
      table += '</tbody></table>';

      document.getElementById('table-container').innerHTML = table;
    }

    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>




