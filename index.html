<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Dati da Google Sheet</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/tabletop@1.5.1/tabletop.js"></script>
</head>
<body>
  <div class="container">
    <h1>ðŸ“Š Dati da Google Sheets</h1>
    <p>Questa tabella mostra i dati aggiornati in tempo reale dal foglio Google.</p>
    <div id="table-container">Caricamento dati...</div>
  </div>

  <script>
    const publicSpreadsheetId = '2PACX-1vQ4_CU-hS1RLEXHFqxK_RFSK1D6d18nVWZDMr5g97iIMqqDtOG-H_XBgfClTfxtIlRqrgPbhog_CfLy';

    function init() {
      Tabletop.init({
        key: publicSpreadsheetId,
        callback: showInfo,
        simpleSheet: true
      });
      }

    function showInfo(data, tabletop) {
      let table = '<table><thead><tr>';
      for (let key in data[0]) {
        table += `<th>${key}</th>`;
      }
      table += '</tr></thead><tbody>';
      data.forEach(row => {
        table += '<tr>';
        for (let key in row) {
          table += `<td>${row[key]}</td>`;
        }
        table += '</tr>';
      });
      table += '</tbody></table>';
      document.getElementById('table-container').innerHTML = table;
    }

    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>





